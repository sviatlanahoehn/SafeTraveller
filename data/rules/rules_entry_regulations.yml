version: "2.0"
rules:
#------Second query-----
  - rule: air_travel
    steps:
    - intent: inform_air_travel
    - action: transportation_type_form
    - active_loop: transportation_type_form
  - rule: land_travel
    steps:
    - intent: inform_land_travel
    - action: transportation_type_form
    - active_loop: transportation_type_form

#    - action: set_regulations_type_form
#    - active_loop: set_regulations_type_form
#    - active_loop: null
  - rule: Submit transportation_type_form
    condition:
    - active_loop: transportation_type_form
    steps:
    - action: transportation_type_form
    - active_loop: null
    - action: action_extract_countries
    wait_for_user_input: false
#====== RULES FOR RUNNING THE QUERY ACTION ======
  - rule: correct country->activate <48h_form II
    condition:
    - active_loop: confirm_country_form
    - slot_was_set:
      - correct_countries: true
    steps:
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: stay_OR_transit_form
    - active_loop: stay_OR_transit_form
  - rule: correct country_II->activate <48h_form II
    condition:
    - active_loop: country_form_II
    steps:
    - action: country_form_II
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: action_check_area
    - action: stay_OR_transit_form
    - active_loop: stay_OR_transit_form
#====== FORMS ACTIVATION ======
# ===== BELGIUM =====
  - rule: journey to BE
    condition:
    - active_loop: stay_OR_transit_form
    - slot_was_set:
      - country_to: Belgium
      - transit: false
    steps:
    - action: stay_OR_transit_form
    - active_loop: null
    - action: <48h_form
    - active_loop: <48h_form
  - rule: BE activate plane_travel_form
    condition:
    - active_loop: <48h_form
    - slot_was_set:
      - <48h: true
    steps:
    - action: <48h_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: plane_travel_form
    - active_loop: plane_travel_form
  - rule: BE/NL deactivate plane_travel_form
    condition:
    - active_loop: plane_travel_form
    steps:
    - action: plane_travel_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: children_travel_form
    - active_loop: children_travel_form
# ===== BELGIUM =====
  - rule: <48h_rule
    condition:
    - active_loop: <48h_form
    - slot_was_set:
      - <48h: false
    steps:
    - action: <48h_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: children_travel_form
    - active_loop: children_travel_form
    wait_for_user_input: false

# ===== NETHERLANDS =====
#====== FORMS ACTIVATION ======
  - rule: journey to NL
    condition:
    - active_loop: stay_OR_transit_form
    - slot_was_set:
      - country_to: Netherlands
      - transit: false
    steps:
    - action: stay_OR_transit_form
    - active_loop: null
    - action: plane_travel_form
    - active_loop: plane_travel_form
# ===== NETHERLANDS =====
#====== FORMS BEACTIVATION ======
# ===== NETHERLANDS =====


#====== FORMS ACTIVATION ======
# ===== LUXEMBOURG =====
  - rule: journey to LU
    condition:
    - active_loop: stay_OR_transit_form
    - slot_was_set:
      - country_to: Luxembourg
      - transit: false
    steps:
    - action: stay_OR_transit_form
    - active_loop: null
    - action: plane_travel_form
    - active_loop: plane_travel_form
  - rule: LU submit plane_travel_form
    condition:
    - active_loop: plane_travel_form
    - slot_was_set:
      - country_to: Luxembourg
      - plane_travel: false
    steps:
    - action: plane_travel_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: children_travel_form
    - active_loop: children_travel_form
  - rule: LU activate transport_health_worker_form
    condition:
    - active_loop: plane_travel_form
    - slot_was_set:
      - country_to: Luxembourg
      - plane_travel: true
    steps:
    - action: plane_travel_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: transport_health_worker_form
    - active_loop: transport_health_worker_form
#====== FORMS BEACTIVATION ======
# ===== LUXEMBOURG =====
  - rule: LU Submit transport_health_worker_form
    condition:
    - active_loop: transport_health_worker_form
    steps:
    - action: transport_health_worker_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: children_travel_form
    - active_loop: children_travel_form


# ===== QUERY ACTION CALL =====
  - rule: Submit children_travel_form
    condition:
    - active_loop: children_travel_form
    steps:
    - action: children_travel_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    #- action: action_ask_confirm_collected_info
    #- action: confirm_form
    #- active_loop: confirm_form
    - action: action_query_knowledgebase_cases
    wait_for_user_input: false

#TRANSIT ---> ????
#  - rule: LU/NL Submit transit_BE_form
#    condition:
#    - active_loop: transit_BE_form
#    steps:
#    - action: transit_BE_form
#    - active_loop: null
#    - slot_was_set:
#      - requested_slot: null
#    - action: children_travel_form
#    - active_loop: children_travel_form