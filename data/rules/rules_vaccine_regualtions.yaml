version: "2.0"
rules:

  - rule: choose vaccine regulations type
    condition:
    - active_loop: regulation_type_form
    - slot_was_set:
      - regulations_type: vaccine_regulations
    steps:
    - action: regulation_type_form
    - active_loop: null
    - action: vaccine_regulations_form
    - active_loop: vaccine_regulations_form

  - rule: submit vaccine_regulations_form
    condition:
    - active_loop: vaccine_regulations_form
    steps:
    - action: vaccine_regulations_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: action_validate_countries

  - rule: wrong country of vaccine_regulations
    condition:
    - slot_was_set:
      - regulations_type: vaccine_regulations
      - country_to: None
    steps:
    - action: action_validate_countries
    - action: vaccine_regulations_form
    - active_loop: vaccine_regulations_form

  - rule: correct country of vaccine_regulations
    condition:
    - slot_was_set:
      - regulations_type: vaccine_regulations
    steps:
    - action: action_validate_countries
    - action: action_query_knowledgebase_cases
    wait_for_user_input: false

  - rule: query vaccine regulations
    steps:
    - intent: query_vaccine_regulations
#    - action: action_extract_countries
    - action: set_regulations_type_form
    - active_loop: set_regulations_type_form
    - active_loop: null
    - action: vaccine_regulations_form
    - active_loop: vaccine_regulations_form
