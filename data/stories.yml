version: "2.0"
stories:
  - story: begin 1.0)
    steps:
    - intent: inform
      entities:
      - country: Luxembourg
        role: to
    - action: action_validate_countries
  - story: begin 1.1)
    steps:
    - intent: inform
      entities:
      - country: Luxembourg
        role: from
    - action: action_validate_countries
  - story: begin 2.0)
    steps:
    - intent: inform
      entities:
      - country: Germany
        role: to
    - action: action_validate_countries
  - story: begin 2.1)
    steps:
    - intent: inform
      entities:
      - country: Germany
        role: from
    - action: action_validate_countries
  - story: begin 3.0)
    steps:
    - intent: inform
      entities:
      - country: Netherlands
        role: to
    - action: action_validate_countries
  - story: beginning conv
    steps:
    - action: action_validate_countries
    - slot_was_set:
      - country_to: Luxembourg
      - country_from: Netherlands
      - regulations_type: entry_regulations
      - common_border: true
    - action: country_form
    - active_loop: null
    - action: action_check_borders
    - slot_was_set:
      - common_border: true
    - action: confirm_country_form
    - slot_was_set:
      - correct_countries: true
    - active_loop: null
    - action: utter_warn_collect_info
    - action: transport_type_form
    - active_loop: transport_type_form


# ===== LOCAL REGULATIONS =====
  - story: local_regulations asked
    steps:
    - intent: query_local_regulations
      entities:
      - regulations_type: local_regulations
    - action: correct_local_form
    - active_loop: correct_local_form


  - story: confirmed local
    steps:
    - action: correct_local_form
    - active_loop: null
    - slot_was_set:
      - correct_info: true
    - action: action_set_local
    - action: local_regulations_form
    - active_loop: local_regulations_form
    - active_loop: null
    - slot_was_set:
      #- location: "Germany"
      - country_to: Germany
      - indoors/outdoors: outdoors
    - action: open_places_form
    - active_loop: null
    - slot_was_set:
      - want_open_places: false
    - action: action_query_knowledgebase_cases
  - story: local_reg + indoors
    steps:
    - action: correct_local_form
    - active_loop: null
    - slot_was_set:
      - correct_info: true
    - action: action_set_local
    - action: local_regulations_form
    - active_loop: local_regulations_form
    - active_loop: null
    - slot_was_set:
      - country_to: Luxembourg
      - indoors/outdoors: indoors
    - action: open_places_form
    - active_loop: null
    - action: action_query_knowledgebase_cases
  - story: local_reg + country Luxembourg
    steps:
    - action: correct_local_form
    - active_loop: null
    - slot_was_set:
      - correct_info: true
    - action: action_set_local
    - action: local_regulations_form
    - active_loop: local_regulations_form
    - active_loop: null
    - slot_was_set:
      - country_to: Luxembourg
      - indoors/outdoors: outdoors
    - action: extended_local_regulations_form
    - active_loop: null
    - slot_was_set:
      - going_from_work: true
      - one_household: false
    - action: open_places_form
    - active_loop: null
    - slot_was_set:
      - want_open_places: true
    - action: action_query_knowledgebase_cases


# ====== TO-GERMANY STORIES ======
  - story: from LU to DE + <24h
    steps:
    - action: action_validate_countries
    - slot_was_set:
      - regulations_type: entry_regulations
      - country_to: Germany
      - country_from: Luxembourg
    - action: country_form
    - active_loop: null
    - action: action_check_borders
    - slot_was_set:
      - common_border: true
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - correct_countries: true
    - action: utter_warn_collect_info
    - action: <24h_form
    - active_loop: <24h_form
    - active_loop: null
    - slot_was_set:
      - <24h: true
    - action: children_travel_form
    - active_loop: children_travel_form
  - story: from NL to DE + leisure
    steps:
    - action: action_validate_countries
    - slot_was_set:
      - country_to: Germany
      - country_from: Netherlands
      - regulations_type: entry_regulations
    - action: country_form
    - active_loop: null
    - action: action_check_borders
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - correct_countries: true
    - action: utter_warn_collect_info
    - action: <24h_form
    - active_loop: <24h_form
    - active_loop: null
    - slot_was_set:
      - <24h: false
    - action: visit_purpose_form
    - active_loop: visit_purpose_form
    - active_loop: null
    - slot_was_set:
      - visit_purpose: leisure
    - action: children_travel_form
    - active_loop: children_travel_form
  - story: to DE + work
    steps:
    - slot_was_set:
      - <24h: false
    - action: visit_purpose_form
    - active_loop: visit_purpose_form
    - active_loop: null
    - slot_was_set:
      - visit_purpose: work
    - action: transport_sector_worker_form
    - action: action_query_knowledgebase_cases


# ====== TO-LUXEMBOURG STORIES ======
  - story: from DE to LUX + by land
    steps:
    - action: action_validate_countries
    - slot_was_set:
      - country_to: Luxembourg
      - country_from: Germany
      - regulations_type: entry_regulations
    - action: country_form
    - active_loop: null
    - action: action_check_borders
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - correct_countries: true
    - action: utter_warn_collect_info
    - action: transport_type_form
    - active_loop: transport_type_form
    - active_loop: null
    - slot_was_set:
      - transport_type: car
    - action: children_travel_form
    - active_loop: children_travel_form
  - story: from DE/NL to LUX + by plane + worker
    steps:
    - action: action_validate_countries
    - slot_was_set:
      - country_to: Luxembourg
    - action: country_form
    - active_loop: null
    - action: action_check_borders
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - correct_countries: true
    - action: utter_warn_collect_info
    - action: transport_type_form
    - active_loop: transport_type_form
    - active_loop: null
    - slot_was_set:
      - transport_type: plane
    - action: transport_sector_worker_form
    - active_loop: null
    - slot_was_set:
      - transport_sector_worker: true
    - action: action_query_knowledgebase_cases
  - story: from DE/NL to LUX + by plane
    steps:
    - action: country_form
    - active_loop: null
    - slot_was_set:
      - country_to: Luxembourg
    - action: action_check_borders
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - correct_countries: true
    - action: utter_warn_collect_info
    - action: transport_type_form
    - active_loop: transport_type_form
    - active_loop: null
    - slot_was_set:
      - transport_type: plane
    - action: transport_sector_worker_form
    - active_loop: null
    - slot_was_set:
      - transport_sector_worker: false
    - action: children_travel_form
    - active_loop: null
    - action: action_query_knowledgebase_cases
  - story: from NL to LUX + by land
    steps:
    - action: country_form
    - active_loop: null
    - slot_was_set:
      - country_to: Luxembourg
      - country_from: Netherlands
    - action: action_check_borders
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - correct_countries: true
    - action: utter_warn_collect_info
    - action: transport_type_form
    - active_loop: transport_type_form
    - active_loop: null
    - slot_was_set:
      - transport_type: car
    - action: transit_DE_form
    - action: children_travel_form
    - active_loop: children_travel_form


# ====== TO-the-NETHERLANDS STORIES =======
  - story: from DE to NL + worker rule
    steps:
    - slot_was_set:
      - country_to: Netherlands
      - country_from: Germany
      - regulations_type: entry_regulations
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - correct_countries: true
    - action: utter_warn_collect_info
    - action: visit_purpose_form
    - slot_was_set:
      - visit_purpose: work
    - action: NL_worker_form
    - action: action_query_knowledgebase_cases
  - story: from DE to NL + leisure
    steps:
    - slot_was_set:
      - country_to: Netherlands
      - country_from: Germany
      - regulations_type: entry_regulations
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - correct_countries: true
    - action: utter_warn_collect_info
    - action: visit_purpose_form
    - slot_was_set:
      - visit_purpose: leisure
    - action: transport_type_form
    - slot_was_set:
      - transport_type: plane
    - action: children_travel_form
    - active_loop: children_travel_form
  - story: from DE to NL + family
    steps:
    - slot_was_set:
      - country_to: Netherlands
      - country_from: Germany
      - regulations_type:
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - correct_countries: true
    - action: utter_warn_collect_info
    - action: visit_purpose_form
    - slot_was_set:
      - visit_purpose: family
    - action: transport_type_form
    - slot_was_set:
      - transport_type: car
    - action: children_travel_form
    - active_loop: children_travel_form
#(do workers go from NL to LUX?)
  - story: from LUX to NL + worker rule
    steps:
    - slot_was_set:
      - country_to: Netherlands
      - country_from: Luxembourg
      - regulations_type: entry_regulations
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - correct_countries: true
    - action: utter_warn_collect_info
    - action: visit_purpose_form
    - slot_was_set:
      - visit_purpose: work
    - action: NL_worker_form
    - action: transit_DE_form
    - action: action_query_knowledgebase_cases
  - story: from LUX to NL + leisure
    steps:
    - slot_was_set:
      - country_to: Netherlands
      - country_from: Luxembourg
      - regulations_type: entry_regulations
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - correct_countries: true
    - action: utter_warn_collect_info
    - action: visit_purpose_form
    - slot_was_set:
      - visit_purpose: leisure
    - action: transport_type_form
    - slot_was_set:
      - transport_type: plane
    - action: children_travel_form
    - active_loop: children_travel_form
  - story: from LUX to NL + family
    steps:
    - slot_was_set:
      - country_to: Netherlands
      - country_from: Luxembourg
      - regulations_type: entry_regulations
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - correct_countries: true
    - action: utter_warn_collect_info
    - action: visit_purpose_form
    - slot_was_set:
      - visit_purpose: leisure
    - action: transport_type_form
    - active_loop: null
    - slot_was_set:
      - transport_type: coach
    - action: transit_DE_form
    - active_loop: null
    - slot_was_set:
      - transit_DE: true
    - action: children_travel_form
    - active_loop: children_travel_form


# ===== ENTRY REGULATIONS =====
  - story: correct to/from countries extracted
    steps:
    - intent: query_regulations
      entities:
      - country: Luxembourg
        role: from
      - country: Germany
        role: to
    - action: action_validate_countries
    - slot_was_set:
      - common_border: true
      - regulations_type: entry_regulations
      - country_to: Germany
      - country_from: Luxembourg
    - action: country_form
    - active_loop: null
    - action: action_check_borders
    - action: confirm_country_form
    - active_loop: null
    - slot_was_set:
      - correct_countries: true
    - action: utter_warn_collect_info
    - action: <24h_form
    - active_loop: <24h_form
    - active_loop: null
    - slot_was_set:
      - <24h: true
    - action: children_travel_form
    - active_loop: children_travel_form


# === QUERY the REGULATIONS after the CHILDREN FORM ===
  - story: story for children form submitting
    steps:
    - action: children_travel_form
    - active_loop: null
    - slot_was_set:
      - travelling_with_children: false
    - action: action_query_knowledgebase_cases